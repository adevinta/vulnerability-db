/*
Copyright 2020 Adevinta
*/

package processor

// Notification is the message received in the queue from the Vulcan Core SNS topic.
type Notification struct {
	Type             string `json:"Type"`
	MessageID        string `json:"MessageId"`
	TopicArn         string `json:"TopicArn"`
	Subject          string `json:"Subject"`
	Message          string `json:"Message"`
	Timestamp        string `json:"Timestamp"`
	SignatureVersion string `json:"SignatureVersion"`
	Signature        string `json:"Signature"`
	SigningCertURL   string `json:"SigningCertURL"`
	UnsubscribeURL   string `json:"UnsubscribeURL"`
}

// CheckMessage is the information of the check that comes inside the Notification.
type CheckMessage struct {
	ID            string  `json:"id"`
	AgentID       string  `json:"agent_id"`
	ChecktypeID   string  `json:"checktype_id"`
	ChecktypeName string  `json:"checktype_name"`
	Status        string  `json:"status"`
	Target        string  `json:"target"`
	Options       string  `json:"options"`
	Webhook       string  `json:"webhook"`
	Score         float64 `json:"score"`
	Progress      float64 `json:"progress"`
	Raw           string  `json:"raw"`
	Report        string  `json:"report"`
	DeletedAt     string  `json:"deleted_at"`
	CreatedAt     string  `json:"created_at"`
	UpdatedAt     string  `json:"updated_at"`
	ScanID        string  `json:"scan_id"`
	QueueName     string  `json:"queue_name"`
	Tag           string  `json:"tag"`
}

// FindingNotification is the data that's notified when a new finding occurs.
type FindingNotification struct {
	TargetID         string        `json:"target_id"`
	Target           string        `json:"target"`
	IssueID          string        `json:"issue_id"`
	FindingID        string        `json:"finding_id"`
	CheckID          string        `json:"check_id"`
	ChecktypeName    string        `json:"checktype_name"`
	CheckTypeOptions string        `json:"checktype_options"`
	Tag              string        `json:"tag"`
	Vulnerability    vulnerability `json:"vulnerability"`
}

type vulnerability struct {
	ID          string  `json:"id"`
	Summary     string  `json:"summary"`
	Score       float32 `json:"score"`
	CWEID       uint32  `json:"cwe_id"`
	Description string  `json:"description"`
}
