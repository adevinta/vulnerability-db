/*
Copyright 2020 Adevinta
*/

package notify

import (
	"github.com/adevinta/vulnerability-db/pkg/store"
)

// FindingNotification represents a notification associated with a finding state change.
type FindingNotification struct {
	store.FindingExpanded
	// TODO: Tag field is defined here in order for the FindingNotification struct to be
	// backward compatible with the "old" vulnerability notifications format so integrations
	// with external components that still use the old representation (e.g.: Hermes) are
	// maintained and can be isolated in the notify pkg. Once these integrations are modified
	// to use the new notification format we'll have to decide if we make this tag field
	// serializable into JSON and keep using the tag field as identifier, or we migrate to use
	// the current team identifier.
	Tag string `json:"-"`
}

// Notifier is a connector that allows
// to push messages to a notification service.
type Notifier interface {
	PushFinding(f FindingNotification) error
}
