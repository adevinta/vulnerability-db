CREATE TABLE last_sources (
    finding_id TEXT PRIMARY KEY REFERENCES findings(id),
    source_id TEXT REFERENCES sources(id)
);

WITH ls AS (
    SELECT DISTINCT ON (finding_id) finding_id, source_id, time
    FROM finding_events
    ORDER BY finding_id, time DESC
)
INSERT INTO last_sources
SELECT ls.finding_id, ls.source_id from ls;
