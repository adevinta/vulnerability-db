-- Creates the fingerprint column
ALTER TABLE finding_events ADD fingerprint text;

-- Set specific value for fingerprint if fingerprint is null or empty
UPDATE finding_events SET fingerprint = 'NOT_PROVIDED' where fingerprint = '' or fingerprint is null;

-- Add NOT NULL and NOT EMPTY constraints to fingerprint column
ALTER TABLE finding_events ALTER COLUMN fingerprint SET NOT NULL;
ALTER TABLE finding_events ADD CONSTRAINT check_fingerprint_not_empty CHECK (fingerprint <> '');
